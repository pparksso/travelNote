{% include "include/header.html" %}
<div id="utilBox">
  <div class="txtBox"><p>{{ title }}</p></div>
  <div class="utilMenu">
    {% if userInfo %}
    <a href="/user/logout" id="logoutBtn"><span>Logout</span></a>
    <a href="/user/mypage" id="mypageBtn"><span>My Page</span></a>
    {% else %}
    <!-- ë¡œê·¸ì¸ì´ ìê¾¸ í’€ë ¤ì„œ ì²´í¬ìš©ìœ¼ë¡œ -->
    <a href="" id="loginBtn"><span>Login</span></a>
    <a href="" id="joinBtn"><span>Join</span></a>
    {% endif %}
  </div>
</div>
<section id="create" class="subSection">
  <div class="title">
    <h1>Create Post</h1>
  </div>
  <form action="/create/new" method="POST" enctype="multipart/form-data">
    <div class="imgBox">
      <img alt="" />
    </div>
    <div class="inputBox">
      <label class="file"><span>íŒŒì¼ì°¾ê¸°</span><input type="file" name="image" id="image" /> <input name="fileName" id="fileName" value="ì²¨ë¶€íŒŒì¼" readonly /></label>
    </div>
    <div class="inputBox dateBox">
      <label><input type="text" name="date" id="date" placeholder="ë…„ë„. ì›”. ì¼" readonly /><span>ğŸ“…</span></label>
    </div>
    <div class="inputBox">
      <label><span>ì œëª©</span><input type="text" name="title" id="title" /></label>
    </div>
    <div class="inputBox">
      <label><span>ì—¬í–‰ì§€</span><input type="text" name="location" id="location" /></label>
    </div>
    <div class="inputBox"><textarea name="desc" id="desc" cols="30" rows="10" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea></div>
    <div class="btns">
      <button id="createBtn"><span>ì¶”ê°€</span></button>
      <button type="reset" id="resetBtn"><span>ì·¨ì†Œ</span></button>
    </div>
  </form>
</section>
<script>
  const fileNameBox = document.querySelector("#fileName");
  const inputFile = document.querySelector("#image");
  const imgBox = document.querySelector("#create .imgBox img");
  const date = document.querySelector("#date");

  //íŒŒì¼ ì²¨ë¶€ í›„ ë°”ë¡œ ì´ë¯¸ì§€ ë„ìš°ê¸°
  inputFile.addEventListener("change", () => {
    const img = document.querySelector("#image");
    const fileName = inputFile.value;
    fileNameBox.value = fileName;
    const sendImgData = new FormData();
    sendImgData.append("image", img.files[0]);
    axios({
      method: "POST",
      url: "/create/sendimg",
      data: sendImgData,
      Headers: {
        enctype: "multipart/form-data",
        contentType: false,
        processData: false,
      },
    }).then((res) => {
      const src = res.data.cloudinaryImgSrc;
      imgBox.setAttribute("src", src);
    });
  });

  const picker = new Lightpick({ field: date, format: "YYYY. MM. DD" });
</script>
{% include "include/footer.html" %}
